# 程序说明

本程序为一款能够即时显示局域网内设备连接和数据通信状态的监控工具，可用于小型机房、工厂以及中小型网络环境的多设备监控工作，能够为网络状态监视、网络数据采集、通信故障排查等事务提供帮助和参考。

![界面预览](preview.png)

## 基本功能

该程序具备以下几个方面的功能特点：

- 显示当前计算机的基本信息（计算机名、系统版本、设备厂商等）；
- 显示当前计算机所安装网络适配器的基本参数（适配器名称、IP地址、网络流量数据等）；
- 显示当前计算机的活动端口信息；
- 显示当前计算机所发现的局域网设备列表以及设备参数（该功能可能需要开启计算机的网络发现功能）；
- 使用SNMP访问交换机，显示交换机内部所提供的网络状态数据，包括：
    - 交换机的型号和固件版本信息；
    - 交换机各个网络端口的连接状态；
    - 交换机内部记录的网络设备列表；
    - 以线状连接图显示目标设备的网络连接状态。

## 界面说明

程序界面共包括七个区域，包括程序顶部的计算机基本信息以及六个用于显示网络相关数据的功能卡片。各个功能卡片的高度和宽度可以通过鼠标拖拽来调整，以适合内容的完整显示。

### 计算机基本信息

该区域可显示以下内容：

- 以图形显示当前计算机的网络连接状态（互联网在线、局域网在线、网络离线）；
- 计算机名称；
- 计算机操作系统版本；
- 设备制造厂商和设备型号；
- 过去2分钟之内的网络流量曲线曲线以及当前的网络传输速度。

### 网卡设备

该卡片显示当前计算机所安装的网络适配器列表，同时显示适配器的以下参数信息：

- 以图形显示该适配器的设备类型（以太网卡、无线网卡）以及连接情况；
- 该适配器的网卡名称、IP地址、MAC地址以及网络带宽数据；
- 该适配器的当前数据传输速度（包括上传和下载）。

### 活动端口

该卡片显示当前计算机内部的活动端口列表，每条数据包含以下参数信息：

- 以图形显示端口通信协议类型（TCP、UDP）；
- 端口通信本地地址以及远程地址；
- 端口通信状态（已连接、等待连接、监听中、未连接等）。

为了提高程序显示效率，仅允许显示最多256条活动端口信息，超出的数据项将被舍弃。

### 局域网设备

该卡片显示当前计算机所发现的局域网设备列表，每个设备会显示以下信息：

- 以图形显示该计算机是否可以通信；
- 该设备的计算机名称、IP地址以及网络地址；
- 显示当前设备到该设备的通信延迟（以毫秒计数）。

注意：该列表的显示需要当前局域网中的计算机开启网络发现功能。

### 交换机接口

该卡片显示交换机设备的网络接口状态，每个设备会显示以下信息：

- 以图形显示该交换机是否可以正常获取监视信息；
- 以图形显示该交换机所拥有的网络端口数量和排列方式，以及各个网络端口是否已连接；
- 显示该交换机的设备型号、生产厂商、系统固件版本等文本内容；
- 鼠标悬浮至交换机图标可以浏览该交换机的部分参数，包括MAC地址、连接IP地址、运行时间等；
- 鼠标悬浮至端口图标可以浏览该端口的网口号、通信状态以及数据流量速度。

### 交换机设备

该卡片显示交换机设备内部所记录的设备列表（ARP表以及MAC地址列表），每个设备会显示以下信息：

- 以图形显示该交换机是否可以正常获取监视信息；
- 显示该交换机内部记录的局域网设备IP地址；
- 鼠标悬浮至设备IP地址可以浏览该设备的详细信息（包括MAC地址、占用网口以及地址类型等）。

注意：交换机获取连接设备的相关信息（IP地址、MAC地址）可能需要一定的刷新时间。

### 网络结构图

该卡片能够以图线形式显示局域网内各个设备的实际连接状态，同时可以实现以下功能：

- 显示多交换机级联状态；
- 显示多网络适配器计算机实际连接状态；
- 显示当前局域网中出现故障时的故障节点位置；
- 当某条网络连接中断时，在程序界面上弹出提示文字；
- 鼠标悬浮至某条网络连接线条上可以浏览该网络连接的具体参数（包括端口号、设备MAC地址等）。

# 相关配置

## 程序设置

使用SNMP交换机监视功能需要修改以下`app.config`文件中的设置项目：

```xml
<appSettings>
    <!-- 是否启用交换机监视功能 -->
    <add key="switch_enable" value="true"/>
    <!-- 交换机用户名称 -->
    <add key="switch_username" value="username"/>
    <!-- 交换机Auth密码 -->
    <add key="switch_auth" value="password"/>
    <!-- 交换机Priv密码 -->
    <add key="switch_priv" value="password"/>
</appSettings>
<!-- 交换机IP列表 -->
<switchList>
    <add key="Switch01" value="172.16.24.1"/>
    <add key="Switch02" value="172.16.25.1"/>
</switchList>
<!-- 局域网设备IP地址列表 -->
<deviceList>
    <add key="Host-A" value="172.16.24.101;172.16.25.101"/>
    <add key="Host-B" value="172.16.24.102;172.16.25.102"/>
    <add key="Host-C" value="172.16.24.103;172.16.25.103"/>
    <add key="Host-D" value="172.16.24.104;172.16.25.104"/>
</deviceList>
<!-- 交换机互联列表 -->
<connectionList>
    <add key="conn-A" value="Switch01;Switch02"/>
</connectionList>
```

## 交换机配置

交换机设备需事先完成以下设置项目：

- 设置交换机默认VLAN的IP地址（可根据需求划分多个VLAN）；
- 启用交换机的Telnet访问功能以及用户权限（可选）；
- 启用交换机的SNMP功能并设置用户访问权限。

## 计算机配置

计算机需完成以下配置：

- 正确配置本地网络适配器连接参数；
- 正常启用防火墙和网络共享功能；
- 启用网络发现功能。

# 注意事项

本程序对于局域网状态的正确显示依赖于各个设备的网络参数配置，因此若某台设备的系统版本较低或是网络配置过程有误，可能会出现本程序的图形显示与实际情况不一致的问题。另外，由于本程序采集各种网络数据需要一定的时间，因此图形显示结果会存在短暂的延迟。

 